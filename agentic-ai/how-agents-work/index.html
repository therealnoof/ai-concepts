<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How AI Agents Work ‚Äî Agentic Workflows</title>

<!-- Font pairing: Manrope for body, Source Code Pro for technical labels -->
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=Source+Code+Pro:wght@400;500;600&display=swap" rel="stylesheet">

<style>
  /* ============================
     CSS VARIABLES
     Copper / burnt orange on deep charcoal.
     Evokes "thinking machines" ‚Äî warm, industrial, active.
     ============================ */
  :root {
    --bg-deep: #0e0c0a;
    --bg-panel: #161210;
    --bg-card: #1e1914;
    --text-primary: #ede4da;
    --text-secondary: #a8978a;
    --text-muted: #6e6058;
    --accent-copper: #e07840;
    --accent-orange: #f09050;
    --accent-peach: #f0b888;
    --accent-teal: #40b8b0;
    --accent-blue: #4898d8;
    --accent-violet: #9878c8;
    --accent-lime: #88c840;
    --accent-rose: #d85868;
    --glow-copper: rgba(224, 120, 64, 0.25);
    --glow-teal: rgba(64, 184, 176, 0.2);
    --border-subtle: rgba(168, 151, 138, 0.1);
    --border-copper: rgba(224, 120, 64, 0.2);
  }

  /* ============================
     RESET & BASE
     ============================ */
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg-deep);
    color: var(--text-primary);
    font-family: 'Manrope', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ============================
     NAVIGATION BAR
     ============================ */
  .nav-bar {
    position: sticky;
    top: 0;
    z-index: 50;
    background: rgba(14, 12, 10, 0.88);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border-subtle);
    padding: 0 24px;
  }

  .nav-inner {
    max-width: 1100px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 52px;
  }

  .nav-brand {
    font-family: 'Source Code Pro', monospace;
    font-size: 0.8rem;
    color: var(--accent-copper);
    letter-spacing: 1.5px;
    text-transform: uppercase;
    opacity: 0.8;
    text-decoration: none;
    transition: opacity 0.2s ease;
  }

  .nav-brand:hover { opacity: 1; }

  .nav-links {
    display: flex;
    align-items: center;
    gap: 4px;
    flex-wrap: wrap;
  }

  .nav-link {
    font-family: 'Manrope', sans-serif;
    font-size: 0.85rem;
    font-weight: 400;
    color: var(--text-secondary);
    text-decoration: none;
    padding: 6px 14px;
    border-radius: 8px;
    transition: all 0.2s ease;
    letter-spacing: 0.2px;
  }

  .nav-link:hover {
    color: var(--text-primary);
    background: rgba(168, 151, 138, 0.08);
  }

  .nav-link.active {
    color: var(--accent-copper);
    background: rgba(224, 120, 64, 0.08);
  }

  .nav-sep {
    width: 3px;
    height: 3px;
    border-radius: 50%;
    background: var(--text-muted);
    opacity: 0.4;
    margin: 0 4px;
  }

  /* ============================
     CONTAINER
     ============================ */
  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 40px 24px;
  }

  /* ============================
     HEADER
     ============================ */
  .header {
    text-align: center;
    margin-bottom: 48px;
  }

  .header h1 {
    font-size: 2.2rem;
    font-weight: 800;
    background: linear-gradient(135deg, var(--accent-copper), var(--accent-orange), var(--accent-peach));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 8px;
    letter-spacing: -0.5px;
  }

  .header .subtitle {
    font-family: 'Source Code Pro', monospace;
    font-size: 0.82rem;
    color: var(--accent-orange);
    letter-spacing: 3px;
    text-transform: uppercase;
    opacity: 0.7;
    margin-bottom: 14px;
  }

  .header p {
    color: var(--text-secondary);
    font-size: 1.05rem;
    font-weight: 300;
    max-width: 700px;
    margin: 0 auto;
    line-height: 1.7;
  }

  /* ============================
     MAIN DIAGRAM SECTION
     ============================ */
  .diagram-section {
    background: var(--bg-panel);
    border: 1px solid var(--border-subtle);
    border-radius: 20px;
    padding: 36px 20px 28px;
    margin-bottom: 36px;
    position: relative;
    overflow: hidden;
  }

  .diagram-section::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image:
      radial-gradient(circle at 1px 1px, rgba(224, 120, 64, 0.03) 1px, transparent 0);
    background-size: 30px 30px;
    pointer-events: none;
  }

  .diagram-svg {
    width: 100%;
    height: auto;
    display: block;
    position: relative;
    z-index: 1;
  }

  /* ============================
     NODE STYLES
     ============================ */
  @keyframes nodeGlow {
    0% { filter: drop-shadow(0 0 0px transparent); }
    35% { filter: drop-shadow(0 0 16px var(--glow-copper)); }
    100% { filter: drop-shadow(0 0 0px transparent); }
  }

  .agent-node {
    cursor: pointer;
    transition: filter 0.3s ease;
  }

  .agent-node:hover {
    filter: drop-shadow(0 0 12px var(--glow-copper));
  }

  .agent-node.active {
    animation: nodeGlow 0.9s ease-out forwards;
  }

  @keyframes arrowPulse {
    0% { stroke-opacity: 0.12; }
    40% { stroke-opacity: 0.85; }
    100% { stroke-opacity: 0.12; }
  }

  .flow-arrow.active {
    animation: arrowPulse 0.6s ease-out forwards;
    stroke-width: 2.5 !important;
  }

  /* ============================
     CONTROLS
     ============================ */
  .controls {
    display: flex;
    justify-content: center;
    gap: 14px;
    margin-top: 22px;
    position: relative;
    z-index: 2;
    flex-wrap: wrap;
  }

  .btn {
    font-family: 'Source Code Pro', monospace;
    font-size: 0.82rem;
    padding: 11px 24px;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    letter-spacing: 0.5px;
    border: 1px solid;
  }

  .btn-walk {
    background: linear-gradient(135deg, rgba(224, 120, 64, 0.15), rgba(240, 144, 80, 0.15));
    border-color: rgba(224, 120, 64, 0.35);
    color: var(--accent-copper);
  }
  .btn-walk:hover {
    background: linear-gradient(135deg, rgba(224, 120, 64, 0.25), rgba(240, 144, 80, 0.25));
    border-color: var(--accent-copper);
    box-shadow: 0 0 20px rgba(224, 120, 64, 0.15);
  }

  .btn-sim {
    background: linear-gradient(135deg, rgba(64, 184, 176, 0.12), rgba(72, 152, 216, 0.12));
    border-color: rgba(64, 184, 176, 0.3);
    color: var(--accent-teal);
  }
  .btn-sim:hover {
    background: linear-gradient(135deg, rgba(64, 184, 176, 0.22), rgba(72, 152, 216, 0.22));
    border-color: var(--accent-teal);
    box-shadow: 0 0 20px rgba(64, 184, 176, 0.15);
  }

  .btn-multi {
    background: linear-gradient(135deg, rgba(152, 120, 200, 0.12), rgba(216, 88, 104, 0.12));
    border-color: rgba(152, 120, 200, 0.3);
    color: var(--accent-violet);
  }
  .btn-multi:hover {
    background: linear-gradient(135deg, rgba(152, 120, 200, 0.22), rgba(216, 88, 104, 0.22));
    border-color: var(--accent-violet);
    box-shadow: 0 0 20px rgba(152, 120, 200, 0.15);
  }

  .btn:active { transform: scale(0.97); }

  .status-bar {
    text-align: center;
    margin-top: 16px;
    font-family: 'Source Code Pro', monospace;
    font-size: 0.82rem;
    color: var(--accent-copper);
    min-height: 24px;
    opacity: 0;
    transition: opacity 0.3s ease;
    position: relative;
    z-index: 2;
  }
  .status-bar.visible { opacity: 1; }

  /* ============================
     STEP DETAIL CARDS
     ============================ */
  .steps-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 18px;
    margin-top: 36px;
  }

  @media (min-width: 768px) {
    .steps-grid { grid-template-columns: repeat(2, 1fr); }
  }

  .step-card {
    background: var(--bg-card);
    border: 1px solid var(--border-subtle);
    border-radius: 14px;
    padding: 24px;
    position: relative;
    transition: all 0.3s ease;
    overflow: hidden;
  }

  .step-card::before {
    content: '';
    position: absolute;
    top: 16px;
    bottom: 16px;
    left: 0;
    width: 3px;
    border-radius: 0 3px 3px 0;
  }

  .step-card:nth-child(1)::before { background: var(--accent-copper); }
  .step-card:nth-child(2)::before { background: var(--accent-orange); }
  .step-card:nth-child(3)::before { background: var(--accent-blue); }
  .step-card:nth-child(4)::before { background: var(--accent-teal); }
  .step-card:nth-child(5)::before { background: var(--accent-lime); }
  .step-card:nth-child(6)::before { background: var(--accent-violet); }
  .step-card:nth-child(7)::before { background: var(--accent-rose); }
  .step-card:nth-child(8)::before { background: var(--accent-peach); }

  .step-card:hover {
    border-color: var(--border-copper);
    transform: translateY(-2px);
  }

  .step-num {
    font-family: 'Source Code Pro', monospace;
    font-size: 0.7rem;
    color: var(--text-muted);
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 8px;
  }

  .step-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 8px;
  }

  .step-desc {
    color: var(--text-secondary);
    font-weight: 300;
    font-size: 0.92rem;
    line-height: 1.65;
  }

  .step-example {
    margin-top: 12px;
    padding: 10px 14px;
    background: rgba(224, 120, 64, 0.06);
    border-left: 2px solid var(--accent-copper);
    border-radius: 0 8px 8px 0;
    font-size: 0.82rem;
    color: var(--accent-peach);
    font-family: 'Source Code Pro', monospace;
    line-height: 1.5;
  }

  /* ============================
     THOUGHT PROCESS SIMULATOR
     Shows an animated "inner monologue" of an agent
     ============================ */
  .sim-panel {
    display: none;
    margin-top: 36px;
    border: 1px solid var(--border-subtle);
    border-radius: 14px;
    overflow: hidden;
    background: var(--bg-card);
  }
  .sim-panel.visible { display: block; }

  .sim-header {
    background: rgba(64, 184, 176, 0.08);
    padding: 16px 24px;
    font-weight: 600;
    font-size: 1rem;
    border-bottom: 1px solid var(--border-subtle);
    color: var(--accent-teal);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .sim-body {
    padding: 24px;
    max-height: 480px;
    overflow-y: auto;
  }

  .sim-entry {
    display: flex;
    gap: 12px;
    margin-bottom: 16px;
    opacity: 0;
    transform: translateY(8px);
    transition: all 0.4s ease;
  }

  .sim-entry.show {
    opacity: 1;
    transform: translateY(0);
  }

  .sim-icon {
    flex-shrink: 0;
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
  }

  .sim-content {
    flex: 1;
  }

  .sim-label {
    font-family: 'Source Code Pro', monospace;
    font-size: 0.7rem;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    margin-bottom: 4px;
  }

  .sim-text {
    font-size: 0.88rem;
    color: var(--text-secondary);
    line-height: 1.55;
    font-weight: 300;
  }

  /* Color coding for different thought types */
  .sim-perceive .sim-icon { background: rgba(224, 120, 64, 0.15); }
  .sim-perceive .sim-label { color: var(--accent-copper); }

  .sim-think .sim-icon { background: rgba(72, 152, 216, 0.15); }
  .sim-think .sim-label { color: var(--accent-blue); }

  .sim-plan .sim-icon { background: rgba(152, 120, 200, 0.15); }
  .sim-plan .sim-label { color: var(--accent-violet); }

  .sim-act .sim-icon { background: rgba(136, 200, 64, 0.15); }
  .sim-act .sim-label { color: var(--accent-lime); }

  .sim-observe .sim-icon { background: rgba(64, 184, 176, 0.15); }
  .sim-observe .sim-label { color: var(--accent-teal); }

  .sim-respond .sim-icon { background: rgba(240, 144, 80, 0.15); }
  .sim-respond .sim-label { color: var(--accent-orange); }

  /* ============================
     MULTI-AGENT PANEL
     ============================ */
  .multi-panel {
    display: none;
    margin-top: 36px;
    border: 1px solid var(--border-subtle);
    border-radius: 14px;
    overflow: hidden;
    background: var(--bg-card);
  }
  .multi-panel.visible { display: block; }

  .multi-header {
    background: rgba(152, 120, 200, 0.08);
    padding: 16px 24px;
    font-weight: 600;
    font-size: 1rem;
    border-bottom: 1px solid var(--border-subtle);
    color: var(--accent-violet);
  }

  .multi-body {
    padding: 24px;
  }

  .multi-desc {
    color: var(--text-secondary);
    font-size: 0.92rem;
    line-height: 1.65;
    font-weight: 300;
    margin-bottom: 20px;
    text-align: center;
    max-width: 640px;
    margin-left: auto;
    margin-right: auto;
  }

  .multi-svg {
    width: 100%;
    max-width: 700px;
    height: auto;
    display: block;
    margin: 0 auto;
  }

  .multi-legend {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.78rem;
    color: var(--text-secondary);
    font-family: 'Source Code Pro', monospace;
  }

  .legend-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    border: 2px solid;
  }

  /* ============================
     TOOLTIP
     ============================ */
  .tooltip {
    position: fixed;
    background: #1e1610;
    border: 1px solid var(--border-copper);
    color: var(--text-primary);
    padding: 10px 14px;
    border-radius: 10px;
    font-size: 0.8rem;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s ease;
    z-index: 100;
    max-width: 260px;
    font-family: 'Manrope', sans-serif;
    box-shadow: 0 8px 24px rgba(0,0,0,0.5);
  }
  .tooltip.visible { opacity: 1; }
  .tooltip-title {
    font-weight: 600;
    color: var(--accent-copper);
    margin-bottom: 4px;
    font-size: 0.82rem;
  }

  /* ============================
     FOOTER
     ============================ */
  .footer {
    text-align: center;
    margin-top: 44px;
    padding-top: 20px;
    border-top: 1px solid var(--border-subtle);
    color: var(--text-muted);
    font-size: 0.78rem;
  }
</style>
</head>
<body>

<!-- ============================
     NAVIGATION BAR
     "Agentic AI" is marked active on this page.
     ============================ -->
<nav class="nav-bar">
  <div class="nav-inner">
    <a href="/" class="nav-brand">‚ö° AI Concepts</a>
    <div class="nav-links">
      <a href="/" class="nav-link">Neural Networks</a>
      <div class="nav-sep"></div>
      <a href="/rag/how-rag-works" class="nav-link">How RAG Works</a>
      <div class="nav-sep"></div>
      <a href="/transformers/how-transformers-work" class="nav-link">Transformers</a>
      <div class="nav-sep"></div>
      <a href="/agentic-ai/how-agents-work" class="nav-link active">Agentic AI</a>
      <div class="nav-sep"></div>
      <a href="/training/how-training-works" class="nav-link">Training Pipeline</a>
      <!-- Add more links here:
      <div class="nav-sep"></div>
      <a href="/prompt-injection" class="nav-link">Prompt Injection</a>
      -->
    </div>
  </div>
</nav>

<!-- Tooltip element -->
<div class="tooltip" id="tooltip">
  <div class="tooltip-title" id="tooltip-title"></div>
  <div id="tooltip-text"></div>
</div>

<div class="container">

  <!-- ============================
       HEADER
       ============================ -->
  <div class="header">
    <div class="subtitle">Autonomous Reasoning &amp; Action</div>
    <h1>How AI Agents Work</h1>
    <p>AI agents go beyond simple question-and-answer. They can <strong>reason</strong>, <strong>plan</strong>, <strong>use tools</strong>, and <strong>take actions</strong> ‚Äî looping until a goal is achieved. Multiple agents can even collaborate, each with specialized roles.</p>
  </div>

  <!-- ============================
       MAIN AGENT LOOP DIAGRAM (SVG)
       
       Shows the core agentic reasoning cycle:
       
       [User Goal] ‚Üí [Perceive] ‚Üí [Think/Reason] ‚Üí [Plan]
                                                        ‚Üì
                        [Observe Result] ‚Üê [Act / Use Tools]
                              ‚Üì
                     [Goal Met?] ‚Üí Yes ‚Üí [Respond to User]
                         ‚Üì No
                     [Loop Back to Think]
       ============================ -->
  <div class="diagram-section">
    <svg class="diagram-svg" viewBox="0 0 960 620" xmlns="http://www.w3.org/2000/svg">

      <defs>
        <marker id="arr-c" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
          <polygon points="0 0, 8 3, 0 6" fill="#e07840" opacity="0.6" />
        </marker>
        <marker id="arr-t" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
          <polygon points="0 0, 8 3, 0 6" fill="#40b8b0" opacity="0.6" />
        </marker>
      </defs>

      <!-- ============================
           CONNECTION ARROWS
           ============================ -->

      <!-- User Goal ‚Üí Perceive -->
      <line class="flow-arrow" id="fa-1" x1="195" y1="80" x2="280" y2="80"
        stroke="#e07840" stroke-opacity="0.12" stroke-width="1.5" marker-end="url(#arr-c)" />

      <!-- Perceive ‚Üí Think -->
      <line class="flow-arrow" id="fa-2" x1="440" y1="80" x2="510" y2="80"
        stroke="#e07840" stroke-opacity="0.12" stroke-width="1.5" marker-end="url(#arr-c)" />

      <!-- Think ‚Üí Plan -->
      <line class="flow-arrow" id="fa-3" x1="670" y1="80" x2="740" y2="80"
        stroke="#e07840" stroke-opacity="0.12" stroke-width="1.5" marker-end="url(#arr-c)" />

      <!-- Plan ‚Üí Act (down) -->
      <path class="flow-arrow" id="fa-4" d="M 830 120 L 830 175 L 680 175 L 680 210"
        fill="none" stroke="#e07840" stroke-opacity="0.12" stroke-width="1.5" marker-end="url(#arr-c)" />

      <!-- Act ‚Üí Observe (left) -->
      <line class="flow-arrow" id="fa-5" x1="540" y1="255" x2="445" y2="255"
        stroke="#e07840" stroke-opacity="0.12" stroke-width="1.5" marker-end="url(#arr-c)" />

      <!-- Observe ‚Üí Goal Check (down) -->
      <line class="flow-arrow" id="fa-6" x1="350" y1="290" x2="350" y2="340"
        stroke="#e07840" stroke-opacity="0.12" stroke-width="1.5" marker-end="url(#arr-c)" />

      <!-- Goal Check ‚Üí Respond (right, "Yes") -->
      <line class="flow-arrow" id="fa-7" x1="445" y1="375" x2="560" y2="375"
        stroke="#40b8b0" stroke-opacity="0.12" stroke-width="1.5" marker-end="url(#arr-t)" />

      <!-- Goal Check ‚Üí Loop back to Think ("No") -->
      <path class="flow-arrow" id="fa-8"
        d="M 255 375 L 180 375 L 180 180 L 510 180 L 510 110"
        fill="none" stroke="#e07840" stroke-opacity="0.12" stroke-width="1.5"
        stroke-dasharray="6 4" marker-end="url(#arr-c)" />

      <!-- ============================
           NODES
           ============================ -->

      <!-- NODE: User Goal -->
      <g class="agent-node" id="node-goal"
         data-tip-title="User Goal"
         data-tip-text="The user provides a high-level objective like 'Book me a flight to NYC under $400 for next Friday.' The agent breaks this down into actionable steps.">
        <rect x="30" y="48" width="160" height="64" rx="12"
          fill="rgba(224, 120, 64, 0.07)" stroke="rgba(224, 120, 64, 0.3)" stroke-width="1.5" />
        <text x="68" y="78" font-size="18">üéØ</text>
        <text x="92" y="76" font-family="Manrope" font-size="13" font-weight="600" fill="#ede4da">User Goal</text>
        <text x="92" y="96" font-family="Source Code Pro" font-size="8" fill="#6e6058">"Book a flight..."</text>
      </g>

      <!-- NODE: Perceive -->
      <g class="agent-node" id="node-perceive"
         data-tip-title="1. Perceive"
         data-tip-text="The agent ingests the user's request plus any available context ‚Äî conversation history, memory, uploaded files, environment state. It builds a picture of the current situation.">
        <rect x="285" y="48" width="150" height="64" rx="12"
          fill="rgba(224, 120, 64, 0.07)" stroke="rgba(224, 120, 64, 0.3)" stroke-width="1.5" />
        <text x="318" y="78" font-size="18">üëÅÔ∏è</text>
        <text x="344" y="76" font-family="Manrope" font-size="13" font-weight="600" fill="#ede4da">Perceive</text>
        <text x="344" y="96" font-family="Source Code Pro" font-size="8" fill="#6e6058">gather context</text>
        <text x="360" y="106" font-family="Source Code Pro" font-size="7" fill="#6e6058" letter-spacing="1">STEP 1</text>
      </g>

      <!-- NODE: Think / Reason -->
      <g class="agent-node" id="node-think"
         data-tip-title="2. Think / Reason"
         data-tip-text="The LLM 'brain' of the agent reasons about what it knows. It uses chain-of-thought reasoning to figure out what needs to happen next. This is where the intelligence lives.">
        <rect x="515" y="44" width="150" height="72" rx="12"
          fill="rgba(72, 152, 216, 0.08)" stroke="rgba(72, 152, 216, 0.3)" stroke-width="1.5" />
        <text x="548" y="78" font-size="18">üß†</text>
        <text x="572" y="74" font-family="Manrope" font-size="13" font-weight="700" fill="#ede4da">Think</text>
        <text x="572" y="92" font-family="Source Code Pro" font-size="8" fill="#6e6058">chain-of-thought</text>
        <text x="572" y="106" font-family="Source Code Pro" font-size="8" fill="#6e6058">reasoning</text>
        <text x="590" y="110" font-family="Source Code Pro" font-size="7" fill="#6e6058" letter-spacing="1">STEP 2</text>
      </g>

      <!-- NODE: Plan -->
      <g class="agent-node" id="node-plan"
         data-tip-title="3. Plan"
         data-tip-text="Based on its reasoning, the agent creates a plan: which tool to use, what API to call, what code to write, or what to search for. It decides the NEXT concrete action.">
        <rect x="745" y="48" width="150" height="64" rx="12"
          fill="rgba(152, 120, 200, 0.08)" stroke="rgba(152, 120, 200, 0.3)" stroke-width="1.5" />
        <text x="778" y="78" font-size="18">üìã</text>
        <text x="802" y="76" font-family="Manrope" font-size="13" font-weight="600" fill="#ede4da">Plan</text>
        <text x="802" y="96" font-family="Source Code Pro" font-size="8" fill="#6e6058">decide next action</text>
        <text x="820" y="106" font-family="Source Code Pro" font-size="7" fill="#6e6058" letter-spacing="1">STEP 3</text>
      </g>

      <!-- NODE: Act / Use Tools -->
      <g class="agent-node" id="node-act"
         data-tip-title="4. Act / Use Tools"
         data-tip-text="The agent EXECUTES the planned action. It sends a tool call through the MCP Client built into the agent, which routes it to the appropriate MCP Server.">
        <rect x="545" y="215" width="200" height="80" rx="12"
          fill="rgba(136, 200, 64, 0.08)" stroke="rgba(136, 200, 64, 0.3)" stroke-width="1.5" />
        <text x="585" y="250" font-size="18">üîß</text>
        <text x="612" y="248" font-family="Manrope" font-size="13" font-weight="600" fill="#ede4da">Act / Use Tools</text>
        <text x="612" y="268" font-family="Source Code Pro" font-size="8" fill="#6e6058">MCP Client sends</text>
        <text x="612" y="280" font-family="Source Code Pro" font-size="8" fill="#6e6058">tool call request</text>
        <text x="645" y="290" font-family="Source Code Pro" font-size="7" fill="#6e6058" letter-spacing="1">STEP 4</text>
      </g>

      <!-- ============================
           MCP LAYER
           This sits between the Agent (Act node) and the External Services.
           The MCP Protocol is the standardized communication channel.

           Flow: Agent ‚Üí MCP Client ‚Üí MCP Protocol ‚Üí MCP Server(s) ‚Üí External Services
                                                                    ‚Üí Results flow back
           ============================ -->

      <!-- Arrow: Act ‚Üí MCP Server layer -->
      <line class="flow-arrow" id="fa-mcp1" x1="748" y1="255" x2="783" y2="255"
        stroke="#e07840" stroke-opacity="0.12" stroke-width="1.5" marker-end="url(#arr-c)" />

      <!-- MCP Protocol bracket / pipe -->
      <rect x="785" y="192" width="8" height="126" rx="4"
        fill="rgba(240, 184, 136, 0.25)" />
      <text x="789" y="188" font-family="Source Code Pro" font-size="7" fill="#f0b888" text-anchor="middle" letter-spacing="1.5">MCP</text>
      <text x="789" y="330" font-family="Source Code Pro" font-size="6" fill="#6e6058" text-anchor="middle" letter-spacing="1">PROTOCOL</text>

      <!-- MCP Server nodes (right side of the protocol pipe) -->

      <!-- MCP Server: Slack -->
      <g class="agent-node" id="node-mcp-slack"
         data-tip-title="MCP Server: Slack"
         data-tip-text="An MCP server that exposes Slack tools ‚Äî search_messages, post_message, list_channels. The agent discovers these tools automatically via the MCP protocol.">
        <rect x="808" y="192" width="138" height="30" rx="6"
          fill="rgba(240, 184, 136, 0.06)" stroke="rgba(240, 184, 136, 0.25)" stroke-width="1" />
        <text x="822" y="211" font-size="11">üí¨</text>
        <text x="840" y="211" font-family="Source Code Pro" font-size="8" fill="#f0b888">Slack Server</text>
      </g>

      <!-- MCP Server: Google Drive -->
      <g class="agent-node" id="node-mcp-gdrive"
         data-tip-title="MCP Server: Google Drive"
         data-tip-text="Exposes file tools ‚Äî search_files, read_document, list_folders. The agent can find and read your documents without custom integration code.">
        <rect x="808" y="228" width="138" height="30" rx="6"
          fill="rgba(240, 184, 136, 0.06)" stroke="rgba(240, 184, 136, 0.25)" stroke-width="1" />
        <text x="822" y="247" font-size="11">üìÅ</text>
        <text x="840" y="247" font-family="Source Code Pro" font-size="8" fill="#f0b888">Drive Server</text>
      </g>

      <!-- MCP Server: Database -->
      <g class="agent-node" id="node-mcp-db"
         data-tip-title="MCP Server: Database"
         data-tip-text="Exposes query tools ‚Äî run_sql, list_tables, describe_schema. Any database can be made agent-accessible by wrapping it in an MCP server.">
        <rect x="808" y="264" width="138" height="30" rx="6"
          fill="rgba(240, 184, 136, 0.06)" stroke="rgba(240, 184, 136, 0.25)" stroke-width="1" />
        <text x="822" y="283" font-size="11">üóÑÔ∏è</text>
        <text x="840" y="283" font-family="Source Code Pro" font-size="8" fill="#f0b888">DB Server</text>
      </g>

      <!-- MCP Server: Custom / Internal APIs -->
      <g class="agent-node" id="node-mcp-custom"
         data-tip-title="MCP Server: Custom APIs"
         data-tip-text="You can build your own MCP servers to expose ANY internal tool or API. This is how enterprises connect agents to proprietary systems ‚Äî CRM, ticketing, inventory, etc.">
        <rect x="808" y="300" width="138" height="30" rx="6"
          fill="rgba(240, 184, 136, 0.06)" stroke="rgba(240, 184, 136, 0.25)" stroke-width="1" />
        <text x="822" y="319" font-size="11">üîå</text>
        <text x="840" y="319" font-family="Source Code Pro" font-size="8" fill="#f0b888">Custom Server</text>
      </g>

      <!-- MCP label and description -->
      <text x="877" y="355" font-family="Source Code Pro" font-size="7" fill="#6e6058" text-anchor="middle" letter-spacing="1">EACH SERVER EXPOSES</text>
      <text x="877" y="366" font-family="Source Code Pro" font-size="7" fill="#6e6058" text-anchor="middle" letter-spacing="1">TOOLS THE AGENT CAN</text>
      <text x="877" y="377" font-family="Source Code Pro" font-size="7" fill="#6e6058" text-anchor="middle" letter-spacing="1">DISCOVER &amp; CALL</text>

      <!-- "USB-C for AI" callout -->
      <rect x="800" y="386" width="155" height="28" rx="6"
        fill="rgba(240, 184, 136, 0.06)" stroke="rgba(240, 184, 136, 0.15)" stroke-width="1" />
      <text x="877" y="404" font-family="Source Code Pro" font-size="8" fill="#f0b888" text-anchor="middle">üîå "USB-C for AI Agents"</text>

      <!-- MCP Client label inside the Act box area -->
      <rect x="548" y="296" width="75" height="16" rx="4"
        fill="rgba(240, 184, 136, 0.1)" stroke="rgba(240, 184, 136, 0.2)" stroke-width="0.5" />
      <text x="586" y="307" font-family="Source Code Pro" font-size="7" fill="#f0b888" text-anchor="middle">MCP CLIENT</text>

      <!-- NODE: Observe Result -->
      <g class="agent-node" id="node-observe"
         data-tip-title="5. Observe Result"
         data-tip-text="The agent examines the output of its action. Did the search return useful results? Did the code run without errors? Was the API response what was expected? This feedback informs the next loop.">
        <rect x="255" y="220" width="185" height="68" rx="12"
          fill="rgba(64, 184, 176, 0.08)" stroke="rgba(64, 184, 176, 0.3)" stroke-width="1.5" />
        <text x="290" y="252" font-size="18">üëÄ</text>
        <text x="316" y="250" font-family="Manrope" font-size="13" font-weight="600" fill="#ede4da">Observe Result</text>
        <text x="316" y="270" font-family="Source Code Pro" font-size="8" fill="#6e6058">evaluate tool output</text>
        <text x="347" y="282" font-family="Source Code Pro" font-size="7" fill="#6e6058" letter-spacing="1">STEP 5</text>
      </g>

      <!-- NODE: Goal Met? (diamond decision) -->
      <g class="agent-node" id="node-check"
         data-tip-title="6. Goal Check"
         data-tip-text="The agent evaluates: do I have enough information to answer the user's question? Is the task complete? If yes ‚Üí respond. If no ‚Üí loop back to Think with the new information.">
        <!-- Diamond shape using a rotated square -->
        <rect x="305" y="345" width="90" height="60" rx="10"
          fill="rgba(240, 144, 80, 0.08)" stroke="rgba(240, 144, 80, 0.3)" stroke-width="1.5" />
        <text x="350" y="372" font-family="Manrope" font-size="11" font-weight="700" fill="#ede4da" text-anchor="middle">Goal Met?</text>
        <text x="350" y="398" font-family="Source Code Pro" font-size="7" fill="#6e6058" text-anchor="middle" letter-spacing="1">STEP 6</text>
      </g>

      <!-- Yes / No labels -->
      <text x="500" y="365" font-family="Source Code Pro" font-size="10" fill="#40b8b0" font-weight="600">YES ‚úì</text>
      <text x="218" y="365" font-family="Source Code Pro" font-size="10" fill="#e07840" font-weight="600">NO ‚Ü∫</text>

      <!-- Loop label -->
      <text x="180" y="275" font-family="Source Code Pro" font-size="8" fill="#6e6058" text-anchor="middle" transform="rotate(-90, 180, 275)">LOOP BACK WITH NEW INFO</text>

      <!-- NODE: Respond to User -->
      <g class="agent-node" id="node-respond"
         data-tip-title="7. Respond to User"
         data-tip-text="The agent delivers its final answer ‚Äî synthesized from all the actions, tool results, and reasoning it performed across potentially many loops. The task is complete.">
        <rect x="565" y="345" width="180" height="60" rx="12"
          fill="rgba(240, 144, 80, 0.1)" stroke="rgba(240, 144, 80, 0.4)" stroke-width="1.5" />
        <text x="602" y="378" font-size="18">‚úÖ</text>
        <text x="628" y="376" font-family="Manrope" font-size="13" font-weight="700" fill="#ede4da">Respond</text>
        <text x="710" y="376" font-family="Source Code Pro" font-size="8" fill="#6e6058">to user</text>
        <text x="655" y="398" font-family="Source Code Pro" font-size="7" fill="#6e6058" letter-spacing="1">STEP 7</text>
      </g>

      <!-- ============================
           BOTTOM LABELS
           ============================ -->
      <text x="480" y="460" font-family="Source Code Pro" font-size="9" fill="#6e6058" text-anchor="middle" letter-spacing="1.5">
        THE AGENT LOOP: PERCEIVE ‚Üí THINK ‚Üí PLAN ‚Üí ACT (via MCP) ‚Üí OBSERVE ‚Üí REPEAT
      </text>

      <text x="480" y="480" font-family="Manrope" font-size="9" fill="#6e6058" text-anchor="middle" font-weight="300">
        MCP standardizes how agents discover and use tools ‚Äî any MCP server works with any MCP-compatible agent
      </text>

      <!-- Key difference callout -->
      <rect x="140" y="500" width="680" height="56" rx="10"
        fill="rgba(64, 184, 176, 0.05)" stroke="rgba(64, 184, 176, 0.15)" stroke-width="1" />
      <text x="480" y="518" font-family="Source Code Pro" font-size="9" fill="#40b8b0" text-anchor="middle" letter-spacing="0.5">
        üí° Chatbot = one response per turn &nbsp;‚îÇ&nbsp; Agent = many actions per turn, looping until task is done
      </text>
      <text x="480" y="534" font-family="Source Code Pro" font-size="8" fill="#f0b888" text-anchor="middle" letter-spacing="0.5">
        üîå MCP = universal standard so agents can plug into any tool without custom integration
      </text>
      <text x="480" y="548" font-family="Manrope" font-size="8" fill="#6e6058" text-anchor="middle">
        Examples: Claude Code, Devin, AutoGPT, LangChain agents, CrewAI &nbsp;‚îÇ&nbsp; MCP Servers: Slack, GitHub, Postgres, custom APIs
      </text>
      </text>

    </svg>

    <!-- Controls -->
    <div class="controls">
      <button class="btn btn-walk" id="btn-walk" onclick="walkthrough()">‚ñ∂ Walk Through the Agent Loop</button>
      <button class="btn btn-sim" id="btn-sim" onclick="toggleSim()">üß† Agent Thought Simulator</button>
      <button class="btn btn-multi" id="btn-multi" onclick="toggleMulti()">ü§ù Multi-Agent Collaboration</button>
    </div>

    <div class="status-bar" id="status-bar"></div>
  </div>

  <!-- ============================
       AGENT THOUGHT SIMULATOR
       Animated inner monologue showing how an agent reasons
       through a real task step by step
       ============================ -->
  <div class="sim-panel" id="sim-panel">
    <div class="sim-header">
      <span>üß† Agent Thought Process ‚Äî "Book a flight to NYC under $400 for next Friday"</span>
      <button class="btn btn-walk" onclick="runSimulation()" style="padding:6px 16px; font-size:0.75rem;">‚ñ∂ Replay</button>
    </div>
    <div class="sim-body" id="sim-body">
      <!-- Entries are added by JavaScript -->
    </div>
  </div>

  <!-- ============================
       MULTI-AGENT PANEL
       Shows how multiple agents collaborate
       ============================ -->
  <div class="multi-panel" id="multi-panel">
    <div class="multi-header">ü§ù &nbsp;Multi-Agent Collaboration</div>
    <div class="multi-body">
      <div class="multi-desc">
        Complex tasks can be split across <strong>specialized agents</strong> that communicate with each other. Each agent has its own role, tools, and expertise ‚Äî like a team of employees working together.
      </div>

      <svg class="multi-svg" viewBox="0 0 700 360" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <marker id="arr-m" markerWidth="7" markerHeight="5" refX="7" refY="2.5" orient="auto">
            <polygon points="0 0, 7 2.5, 0 5" fill="#a8978a" opacity="0.5" />
          </marker>
        </defs>

        <!-- Orchestrator Agent (center top) -->
        <rect x="245" y="20" width="210" height="70" rx="12"
          fill="rgba(224, 120, 64, 0.1)" stroke="rgba(224, 120, 64, 0.35)" stroke-width="1.5" />
        <text x="275" y="52" font-size="16">üéõÔ∏è</text>
        <text x="300" y="52" font-family="Manrope" font-size="12" font-weight="700" fill="#ede4da">Orchestrator Agent</text>
        <text x="300" y="70" font-family="Source Code Pro" font-size="8" fill="#6e6058">delegates tasks, combines results</text>

        <!-- Research Agent (left) -->
        <rect x="30" y="160" width="175" height="70" rx="12"
          fill="rgba(72, 152, 216, 0.08)" stroke="rgba(72, 152, 216, 0.3)" stroke-width="1.5" />
        <text x="55" y="192" font-size="16">üîç</text>
        <text x="78" y="192" font-family="Manrope" font-size="11" font-weight="600" fill="#ede4da">Research Agent</text>
        <text x="78" y="210" font-family="Source Code Pro" font-size="8" fill="#6e6058">web search, data gather</text>

        <!-- Code Agent (center) -->
        <rect x="262" y="160" width="175" height="70" rx="12"
          fill="rgba(136, 200, 64, 0.08)" stroke="rgba(136, 200, 64, 0.3)" stroke-width="1.5" />
        <text x="290" y="192" font-size="16">üíª</text>
        <text x="313" y="192" font-family="Manrope" font-size="11" font-weight="600" fill="#ede4da">Code Agent</text>
        <text x="313" y="210" font-family="Source Code Pro" font-size="8" fill="#6e6058">write & execute code</text>

        <!-- Writer Agent (right) -->
        <rect x="495" y="160" width="175" height="70" rx="12"
          fill="rgba(152, 120, 200, 0.08)" stroke="rgba(152, 120, 200, 0.3)" stroke-width="1.5" />
        <text x="523" y="192" font-size="16">‚úçÔ∏è</text>
        <text x="546" y="192" font-family="Manrope" font-size="11" font-weight="600" fill="#ede4da">Writer Agent</text>
        <text x="546" y="210" font-family="Source Code Pro" font-size="8" fill="#6e6058">draft, edit, summarize</text>

        <!-- Connection lines from Orchestrator to sub-agents -->
        <line x1="290" y1="90" x2="118" y2="155" stroke="#a8978a" stroke-opacity="0.25" stroke-width="1.5" marker-end="url(#arr-m)" />
        <line x1="350" y1="90" x2="350" y2="155" stroke="#a8978a" stroke-opacity="0.25" stroke-width="1.5" marker-end="url(#arr-m)" />
        <line x1="410" y1="90" x2="583" y2="155" stroke="#a8978a" stroke-opacity="0.25" stroke-width="1.5" marker-end="url(#arr-m)" />

        <!-- Bidirectional arrows back up -->
        <line x1="118" y1="160" x2="290" y2="93" stroke="#a8978a" stroke-opacity="0.12" stroke-width="1" stroke-dasharray="4 3" marker-end="url(#arr-m)" />
        <line x1="350" y1="160" x2="350" y2="93" stroke="#a8978a" stroke-opacity="0.12" stroke-width="1" stroke-dasharray="4 3" marker-end="url(#arr-m)" />
        <line x1="583" y1="160" x2="410" y2="93" stroke="#a8978a" stroke-opacity="0.12" stroke-width="1" stroke-dasharray="4 3" marker-end="url(#arr-m)" />

        <!-- Cross-agent communication (horizontal dashed) -->
        <line x1="208" y1="195" x2="258" y2="195" stroke="#a8978a" stroke-opacity="0.15" stroke-width="1" stroke-dasharray="3 3" marker-end="url(#arr-m)" />
        <line x1="440" y1="195" x2="491" y2="195" stroke="#a8978a" stroke-opacity="0.15" stroke-width="1" stroke-dasharray="3 3" marker-end="url(#arr-m)" />

        <!-- Shared Memory / State -->
        <rect x="225" y="280" width="250" height="55" rx="10"
          fill="rgba(240, 184, 136, 0.06)" stroke="rgba(240, 184, 136, 0.2)" stroke-width="1" stroke-dasharray="5 3" />
        <text x="350" y="302" font-family="Source Code Pro" font-size="9" fill="#f0b888" text-anchor="middle" letter-spacing="1">SHARED MEMORY / STATE</text>
        <text x="350" y="320" font-family="Manrope" font-size="8" fill="#6e6058" text-anchor="middle">conversation history, task progress, intermediate results</text>

        <!-- Lines to shared memory -->
        <line x1="118" y1="233" x2="280" y2="280" stroke="#a8978a" stroke-opacity="0.12" stroke-width="1" stroke-dasharray="3 3" />
        <line x1="350" y1="233" x2="350" y2="276" stroke="#a8978a" stroke-opacity="0.12" stroke-width="1" stroke-dasharray="3 3" />
        <line x1="583" y1="233" x2="420" y2="280" stroke="#a8978a" stroke-opacity="0.12" stroke-width="1" stroke-dasharray="3 3" />
      </svg>

      <div class="multi-legend">
        <div class="legend-item">
          <div class="legend-dot" style="border-color: var(--accent-copper); background: rgba(224,120,64,0.2);"></div>
          Orchestrator (delegates)
        </div>
        <div class="legend-item">
          <div class="legend-dot" style="border-color: var(--accent-blue); background: rgba(72,152,216,0.2);"></div>
          Specialist Agents
        </div>
        <div class="legend-item">
          <div class="legend-dot" style="border-color: var(--accent-peach); background: rgba(240,184,136,0.1);"></div>
          Shared Memory
        </div>
      </div>
    </div>
  </div>

  <!-- ============================
       STEP-BY-STEP DETAIL CARDS
       ============================ -->
  <div class="steps-grid">

    <div class="step-card">
      <div class="step-num">Step 01</div>
      <div class="step-title">üéØ User Provides a Goal</div>
      <div class="step-desc">
        Unlike a simple chatbot prompt, an agent receives a <strong>goal</strong> ‚Äî a task that may require multiple steps, tool usage, and iteration to complete. The agent has autonomy to decide <em>how</em> to achieve it.
      </div>
      <div class="step-example">
        "Research the top 5 competitors to F5's AI Guardrails, compare their pricing, and create a summary slide deck."
      </div>
    </div>

    <div class="step-card">
      <div class="step-num">Step 02</div>
      <div class="step-title">üëÅÔ∏è Perceive ‚Äî Gather Context</div>
      <div class="step-desc">
        The agent collects all available information: the user's request, conversation history, any uploaded files, environment state, and system instructions. This forms the agent's "situational awareness."
      </div>
      <div class="step-example">
        The agent notes: user works at F5, focus is AI security, needs competitive analysis ‚Äî this shapes the research approach.
      </div>
    </div>

    <div class="step-card">
      <div class="step-num">Step 03</div>
      <div class="step-title">üß† Think ‚Äî Reason Through Options</div>
      <div class="step-desc">
        The LLM "brain" uses <strong>chain-of-thought reasoning</strong> to analyze the situation. It considers what it knows, what it doesn't know, what tools are available, and what the best approach would be. This is often done in an internal "scratchpad" the user doesn't see.
      </div>
      <div class="step-example">
        "I need to find competitors first. I'll search the web for AI guardrail/gateway vendors, then check each one's pricing page."
      </div>
    </div>

    <div class="step-card">
      <div class="step-num">Step 04</div>
      <div class="step-title">üìã Plan ‚Äî Decide Next Action</div>
      <div class="step-desc">
        Based on reasoning, the agent selects a specific <strong>tool</strong> and formulates the exact action to take. It doesn't execute everything at once ‚Äî it plans one step at a time, adapting based on results.
      </div>
      <div class="step-example">
        Plan: Call web_search("AI guardrails competitors CalypsoAI alternatives 2025") ‚Üí parse results ‚Üí visit top 5 websites.
      </div>
    </div>

    <div class="step-card">
      <div class="step-num">Step 05</div>
      <div class="step-title">üîß Act ‚Äî Execute via MCP</div>
      <div class="step-desc">
        The agent executes its plan by sending a <strong>tool call</strong> through its built-in <strong>MCP Client</strong>. The call travels over the <strong>MCP Protocol</strong> to the appropriate <strong>MCP Server</strong>, which handles the actual interaction with the external service.
      </div>
      <div class="step-example">
        Agent ‚Üí MCP Client ‚Üí MCP Protocol ‚Üí Slack MCP Server ‚Üí Slack API ‚Üí results flow back the same path.
      </div>
    </div>

    <div class="step-card">
      <div class="step-num">Key Concept</div>
      <div class="step-title">üîå MCP ‚Äî The Universal Connector</div>
      <div class="step-desc">
        <strong>Model Context Protocol</strong> is a standardized way for agents to discover and use tools. Without MCP, every agent needs custom integration code for every service. With MCP, you build one server per service and <em>any</em> MCP-compatible agent can use it. Think of it as <strong>USB-C for AI agents</strong> ‚Äî one universal plug.
      </div>
      <div class="step-example">
        Components: MCP Client (inside the agent) ‚Üî MCP Protocol (JSON-RPC) ‚Üî MCP Server (exposes tools) ‚Üî External Service (Slack, DB, API...)
      </div>
    </div>

    <div class="step-card">
      <div class="step-num">Step 06</div>
      <div class="step-title">üëÄ Observe ‚Äî Evaluate Results</div>
      <div class="step-desc">
        The agent examines the tool's output. Did the search return useful results? Did the code run without errors? Was the API response what was expected? This feedback becomes new context for the next reasoning cycle.
      </div>
      <div class="step-example">
        "The search returned 8 results. I can see CalypsoAI, Robust Intelligence, Arthur AI, and Lakera. I still need pricing ‚Äî let me fetch each site."
      </div>
    </div>

    <div class="step-card">
      <div class="step-num">Step 07</div>
      <div class="step-title">üîÑ Loop or Respond</div>
      <div class="step-desc">
        The agent checks: <strong>is the goal complete?</strong> If not, it loops back to Think with the new information. An agent might loop 3-20+ times for complex tasks. When the goal is met, it synthesizes everything into a final response.
      </div>
      <div class="step-example">
        Loop 1: search competitors ‚Üí Loop 2: fetch pricing pages ‚Üí Loop 3: compare features ‚Üí Loop 4: create the slide deck ‚Üí Done!
      </div>
    </div>

    <div class="step-card">
      <div class="step-num">Key Concept</div>
      <div class="step-title">ü§ù Multi-Agent Systems</div>
      <div class="step-desc">
        For very complex tasks, multiple specialized agents can collaborate. An <strong>orchestrator agent</strong> delegates subtasks to specialist agents (researcher, coder, writer), each with their own tools and expertise. They share results through a common memory/state.
      </div>
      <div class="step-example">
        Frameworks: CrewAI, AutoGen, LangGraph, OpenAI Swarm, Anthropic's multi-agent patterns. Used for software dev, research, content pipelines.
      </div>
    </div>

  </div>

  <div class="footer">
    Interactive Agentic AI Diagram ‚Äî Walk through the agent loop, simulate agent reasoning, or explore multi-agent collaboration
  </div>
</div>

<script>
  // ============================
  // TOOLTIP FUNCTIONALITY
  // ============================
  const tooltipEl = document.getElementById('tooltip');
  const tooltipTitle = document.getElementById('tooltip-title');
  const tooltipText = document.getElementById('tooltip-text');

  document.querySelectorAll('.agent-node').forEach(node => {
    node.addEventListener('mouseenter', () => {
      tooltipTitle.textContent = node.getAttribute('data-tip-title');
      tooltipText.textContent = node.getAttribute('data-tip-text');
      tooltipEl.classList.add('visible');
    });
    node.addEventListener('mousemove', (e) => {
      tooltipEl.style.left = (e.clientX + 16) + 'px';
      tooltipEl.style.top = (e.clientY - 10) + 'px';
    });
    node.addEventListener('mouseleave', () => {
      tooltipEl.classList.remove('visible');
    });
  });

  // ============================
  // WALKTHROUGH ANIMATION
  // ============================
  let isWalking = false;

  const walkthroughSteps = [
    { nodeId: 'node-goal',    arrowIds: ['fa-1'],  status: 'üéØ User provides a goal: "Book a flight to NYC under $400"' },
    { nodeId: 'node-perceive',arrowIds: ['fa-2'],  status: 'üëÅÔ∏è Step 1: Agent gathers context ‚Äî who, what, when, constraints...' },
    { nodeId: 'node-think',   arrowIds: ['fa-3'],  status: 'üß† Step 2: Agent reasons ‚Äî "I need to search flights, compare prices..."' },
    { nodeId: 'node-plan',    arrowIds: ['fa-4'],  status: 'üìã Step 3: Agent plans ‚Äî "First, search for NYC flights on Friday..."' },
    { nodeId: 'node-act',     arrowIds: ['fa-5', 'fa-mcp1'],  status: 'üîß Step 4: Agent calls tool via MCP ‚Üí request routes through MCP Server to Slack API' },
    { nodeId: 'node-observe', arrowIds: ['fa-6'],  status: 'üëÄ Step 5: Agent reads results ‚Äî "Found 3 options: Delta $350, United $380..."' },
    { nodeId: 'node-check',   arrowIds: ['fa-8'],  status: 'üîÑ Goal not met yet ‚Äî need to compare details. Looping back to Think...' },
    { nodeId: 'node-think',   arrowIds: ['fa-3'],  status: 'üß† Thinking again ‚Äî "Let me check baggage fees and times for these 3..."' },
    { nodeId: 'node-plan',    arrowIds: ['fa-4'],  status: 'üìã Planning ‚Äî "Fetch the Delta and United booking pages..."' },
    { nodeId: 'node-act',     arrowIds: ['fa-5', 'fa-mcp1'],  status: 'üîß Acting ‚Äî MCP Client ‚Üí web_fetch via MCP Server ‚Üí Delta and United booking pages' },
    { nodeId: 'node-observe', arrowIds: ['fa-6'],  status: 'üëÄ Observing ‚Äî "Delta: $350, 1 carry-on free, departs 8am. Best option!"' },
    { nodeId: 'node-check',   arrowIds: ['fa-7'],  status: '‚úÖ Goal met! Compiling final answer for user...' },
    { nodeId: 'node-respond', arrowIds: [],         status: '‚úÖ "I found a Delta flight for $350, departing 8am Friday. Shall I book it?"' },
  ];

  function walkthrough() {
    if (isWalking) return;
    isWalking = true;

    const btn = document.getElementById('btn-walk');
    const statusBar = document.getElementById('status-bar');
    btn.textContent = '‚ñ∂ Walking through...';
    btn.style.opacity = '0.6';
    statusBar.classList.add('visible');

    walkthroughSteps.forEach((step, idx) => {
      const delay = idx * 1200;

      setTimeout(() => {
        statusBar.textContent = step.status;

        const node = document.getElementById(step.nodeId);
        node.classList.add('active');
        setTimeout(() => node.classList.remove('active'), 1000);

        step.arrowIds.forEach(id => {
          const arrow = document.getElementById(id);
          if (arrow) {
            arrow.classList.add('active');
            setTimeout(() => arrow.classList.remove('active'), 800);
          }
        });
      }, delay);
    });

    const totalTime = walkthroughSteps.length * 1200 + 1000;
    setTimeout(() => {
      btn.textContent = '‚ñ∂ Walk Through the Agent Loop';
      btn.style.opacity = '1';
      statusBar.textContent = 'üéâ Complete! Notice how the agent looped TWICE before responding.';
      setTimeout(() => statusBar.classList.remove('visible'), 3500);
      isWalking = false;
    }, totalTime);
  }

  // ============================
  // AGENT THOUGHT SIMULATOR
  // Shows a step-by-step animated "inner monologue" of an agent
  // working through a real task, including tool calls and reasoning
  // ============================

  // Each entry represents one "thought" the agent has.
  // type: perceive, think, plan, act, observe, respond
  const simEntries = [
    {
      type: 'perceive',
      icon: 'üëÅÔ∏è',
      label: 'PERCEIVE',
      text: 'User wants a flight to NYC under $400 for next Friday. I have access to web search. No preference for airline was stated. User is in St. Petersburg, FL ‚Äî nearest airports are TPA and PIE.'
    },
    {
      type: 'think',
      icon: 'üß†',
      label: 'REASONING',
      text: 'I need to find flights from Tampa area to NYC-area airports (JFK, LGA, EWR). Budget is $400 max. Let me search for available flights first, then compare options. I should check multiple airlines.'
    },
    {
      type: 'plan',
      icon: 'üìã',
      label: 'PLAN',
      text: 'Action: Call web_search with query "cheap flights TPA to NYC next Friday under $400". This should give me a good starting overview from flight aggregators.'
    },
    {
      type: 'act',
      icon: 'üîß',
      label: 'TOOL CALL ‚Üí MCP',
      text: '‚Üí MCP Client sends request ‚Üí Web Search MCP Server\n‚Üí web_search("cheap flights Tampa to New York Friday round trip under $400")\n‚è≥ MCP Server executing...'
    },
    {
      type: 'observe',
      icon: 'üëÄ',
      label: 'OBSERVATION',
      text: 'Search returned results from Google Flights, Kayak, and Skyscanner. I can see: Delta TPA‚ÜíJFK $289 (6:15am), JetBlue TPA‚ÜíJFK $312 (10:30am), Spirit TPA‚ÜíLGA $178 (7:00am, basic economy). Let me get more detail.'
    },
    {
      type: 'think',
      icon: 'üß†',
      label: 'REASONING',
      text: 'Spirit is cheapest but basic economy means no carry-on bag and likely delays. Delta and JetBlue are more reliable. Let me check if these prices include baggage. The user didn\'t mention return date ‚Äî I should ask, or just present one-way options clearly.'
    },
    {
      type: 'plan',
      icon: 'üìã',
      label: 'PLAN',
      text: 'Action: Fetch the Google Flights page to get full details including baggage fees, layovers, and exact timing for the top 3 options.'
    },
    {
      type: 'act',
      icon: 'üîß',
      label: 'TOOL CALL ‚Üí MCP',
      text: '‚Üí MCP Client sends request ‚Üí Web Fetch MCP Server\n‚Üí web_fetch("https://www.google.com/travel/flights/...")\n‚è≥ MCP Server fetching full flight details...'
    },
    {
      type: 'observe',
      icon: 'üëÄ',
      label: 'OBSERVATION',
      text: 'Full details retrieved. Delta $289 (nonstop, 2h45m, 1 carry-on included). JetBlue $312 (nonstop, 2h50m, 1 carry-on + personal item). Spirit $178 (nonstop, 2h55m, NO bags included ‚Äî add $45 for carry-on = $223 total).'
    },
    {
      type: 'think',
      icon: 'üß†',
      label: 'REASONING',
      text: 'All three are under $400 ‚úì. I now have enough information to present a clear comparison. Delta offers best value for reliability, Spirit is cheapest total even with bag fee, JetBlue is the premium option. I should present all three and let the user choose.'
    },
    {
      type: 'respond',
      icon: '‚úÖ',
      label: 'RESPONSE TO USER',
      text: 'Goal complete! Presenting 3 flight options with full pricing, timing, and baggage details. Recommending Delta as the best balance of price and reliability at $289.'
    },
  ];

  let simRunning = false;

  function runSimulation() {
    if (simRunning) return;
    simRunning = true;

    const body = document.getElementById('sim-body');
    body.innerHTML = '';  // Clear previous entries

    simEntries.forEach((entry, idx) => {
      const delay = idx * 1400;  // 1.4 seconds between entries

      setTimeout(() => {
        // Create the entry DOM element
        const div = document.createElement('div');
        div.className = `sim-entry sim-${entry.type}`;

        div.innerHTML = `
          <div class="sim-icon">${entry.icon}</div>
          <div class="sim-content">
            <div class="sim-label">${entry.label}</div>
            <div class="sim-text">${entry.text}</div>
          </div>
        `;

        body.appendChild(div);

        // Trigger the fade-in animation after a tiny delay
        requestAnimationFrame(() => {
          requestAnimationFrame(() => {
            div.classList.add('show');
          });
        });

        // Auto-scroll to the latest entry
        body.scrollTop = body.scrollHeight;
      }, delay);
    });

    // Reset after simulation completes
    const totalTime = simEntries.length * 1400 + 500;
    setTimeout(() => { simRunning = false; }, totalTime);
  }

  // ============================
  // TOGGLE PANELS
  // ============================
  function toggleSim() {
    const panel = document.getElementById('sim-panel');
    const btn = document.getElementById('btn-sim');

    if (panel.classList.contains('visible')) {
      panel.classList.remove('visible');
      btn.textContent = 'üß† Agent Thought Simulator';
    } else {
      panel.classList.add('visible');
      btn.textContent = 'üß† Hide Thought Simulator';
      // Auto-run the simulation when opened
      setTimeout(() => {
        panel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        runSimulation();
      }, 150);
    }
  }

  function toggleMulti() {
    const panel = document.getElementById('multi-panel');
    const btn = document.getElementById('btn-multi');

    if (panel.classList.contains('visible')) {
      panel.classList.remove('visible');
      btn.textContent = 'ü§ù Multi-Agent Collaboration';
    } else {
      panel.classList.add('visible');
      btn.textContent = 'ü§ù Hide Multi-Agent';
      setTimeout(() => {
        panel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }, 100);
    }
  }
</script>

</body>
</html>
