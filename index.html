<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How an AI Neural Network Works</title>

<!-- Using a distinctive font pairing -->
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

<style>
  /* ============================
     CSS VARIABLES - our color palette
     A dark, techy theme with electric blue/cyan accents
     ============================ */
  :root {
    --bg-dark: #0a0e1a;
    --bg-card: #111827;
    --text-primary: #e2e8f0;
    --text-secondary: #94a3b8;
    --text-muted: #64748b;
    --accent-blue: #38bdf8;
    --accent-cyan: #22d3ee;
    --accent-purple: #a78bfa;
    --accent-green: #4ade80;
    --accent-orange: #fb923c;
    --accent-pink: #f472b6;
    --glow-blue: rgba(56, 189, 248, 0.3);
    --glow-cyan: rgba(34, 211, 238, 0.2);
    --border-subtle: rgba(148, 163, 184, 0.15);
  }

  /* ============================
     RESET & BASE STYLES
     ============================ */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    background: var(--bg-dark);
    color: var(--text-primary);
    font-family: 'Outfit', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ============================
     NAVIGATION BAR
     Fixed-style top nav that sticks as you scroll.
     Uses a frosted glass effect (backdrop-filter blur)
     so the page content shows through slightly.
     Easy to add more links ‚Äî just add more <a> tags.
     ============================ */
  .nav-bar {
    position: sticky;            /* Sticks to top when scrolling */
    top: 0;
    z-index: 50;                 /* Sits above all other content */
    background: rgba(10, 14, 26, 0.85);  /* Semi-transparent dark bg */
    backdrop-filter: blur(12px);          /* Frosted glass blur effect */
    -webkit-backdrop-filter: blur(12px);  /* Safari support */
    border-bottom: 1px solid var(--border-subtle);
    padding: 0 24px;
  }

  .nav-inner {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;  /* Logo left, links right */
    height: 52px;
  }

  /* Site brand / logo text on the left side */
  .nav-brand {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    color: var(--accent-cyan);
    letter-spacing: 1.5px;
    text-transform: uppercase;
    opacity: 0.8;
    text-decoration: none;
    transition: opacity 0.2s ease;
  }

  .nav-brand:hover {
    opacity: 1;
  }

  /* Navigation links container on the right side */
  .nav-links {
    display: flex;
    align-items: center;
    gap: 4px;                    /* Small gap between link items */
  }

  /* Individual navigation link */
  .nav-link {
    font-family: 'Outfit', sans-serif;
    font-size: 0.85rem;
    font-weight: 400;
    color: var(--text-secondary);
    text-decoration: none;
    padding: 6px 14px;
    border-radius: 8px;
    transition: all 0.2s ease;
    letter-spacing: 0.2px;
  }

  .nav-link:hover {
    color: var(--text-primary);
    background: rgba(148, 163, 184, 0.08);
  }

  /* Highlights the currently active page in the nav */
  .nav-link.active {
    color: var(--accent-cyan);
    background: rgba(34, 211, 238, 0.08);
  }

  /* Small separator dot between nav links */
  .nav-sep {
    width: 3px;
    height: 3px;
    border-radius: 50%;
    background: var(--text-muted);
    opacity: 0.4;
    margin: 0 4px;
  }

  /* ============================
     MAIN CONTAINER
     ============================ */
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 24px;
  }

  /* ============================
     HEADER SECTION
     ============================ */
  .header {
    text-align: center;
    margin-bottom: 48px;
  }

  .header h1 {
    font-size: 2.4rem;
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan), var(--accent-purple));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 12px;
    letter-spacing: -0.5px;
  }

  .header p {
    color: var(--text-secondary);
    font-size: 1.1rem;
    font-weight: 300;
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
  }

  /* ============================
     NEURAL NETWORK SVG DIAGRAM
     The main visual - an interactive SVG showing
     the layers of a neural network
     ============================ */
  .diagram-section {
    background: var(--bg-card);
    border: 1px solid var(--border-subtle);
    border-radius: 20px;
    padding: 32px 16px;
    margin-bottom: 40px;
    position: relative;
    overflow: hidden;
  }

  /* Subtle background grid effect */
  .diagram-section::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image: 
      radial-gradient(circle at 1px 1px, rgba(56, 189, 248, 0.05) 1px, transparent 0);
    background-size: 40px 40px;
    pointer-events: none;
  }

  .diagram-svg {
    width: 100%;
    height: auto;
    display: block;
  }

  /* ============================
     NEURON STYLES (circles in the SVG)
     Each neuron pulses gently to show it's "active"
     ============================ */

  /* Pulse animation - neurons glow in and out */
  @keyframes neuronPulse {
    0%, 100% { filter: drop-shadow(0 0 4px var(--glow-blue)); }
    50% { filter: drop-shadow(0 0 12px var(--glow-blue)); }
  }

  .neuron {
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .neuron:hover {
    filter: drop-shadow(0 0 20px var(--glow-blue)) !important;
  }

  /* ============================
     DATA FLOW ANIMATION
     Small dots travel along the connection lines
     to visualize data moving through the network
     ============================ */
  @keyframes flowDot {
    0% { offset-distance: 0%; opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { offset-distance: 100%; opacity: 0; }
  }

  .flow-dot {
    width: 6px;
    height: 6px;
    background: var(--accent-cyan);
    border-radius: 50%;
    position: absolute;
    offset-rotate: 0deg;
    animation: flowDot 2s linear infinite;
    box-shadow: 0 0 8px var(--accent-cyan);
  }

  /* ============================
     SIGNAL ANIMATION
     When "Send Signal" is clicked, neurons
     light up sequentially left to right
     ============================ */
  @keyframes signalFire {
    0% { fill: #1e3a5f; r: 20; }
    30% { fill: #38bdf8; r: 24; }
    60% { fill: #22d3ee; r: 22; }
    100% { fill: #1e3a5f; r: 20; }
  }

  .neuron-circle.firing {
    animation: signalFire 0.6s ease-out forwards;
  }

  @keyframes connectionFlash {
    0% { stroke: rgba(56, 189, 248, 0.08); stroke-width: 1; }
    40% { stroke: rgba(34, 211, 238, 0.7); stroke-width: 2.5; }
    100% { stroke: rgba(56, 189, 248, 0.08); stroke-width: 1; }
  }

  .connection.flashing {
    animation: connectionFlash 0.5s ease-out forwards;
  }

  /* ============================
     LAYER LABELS
     ============================ */
  .layer-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    fill: var(--text-muted);
    text-anchor: middle;
    letter-spacing: 1.5px;
    text-transform: uppercase;
  }

  .layer-sublabel {
    font-family: 'Outfit', sans-serif;
    font-size: 10px;
    fill: var(--text-muted);
    text-anchor: middle;
    opacity: 0.7;
  }

  /* ============================
     CONTROL BUTTON
     Triggers the signal animation
     ============================ */
  .controls {
    text-align: center;
    margin-top: 20px;
    position: relative;
    z-index: 2;
  }

  .btn-signal {
    background: linear-gradient(135deg, rgba(56, 189, 248, 0.15), rgba(34, 211, 238, 0.15));
    border: 1px solid rgba(56, 189, 248, 0.3);
    color: var(--accent-cyan);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85rem;
    padding: 12px 28px;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    letter-spacing: 0.5px;
  }

  .btn-signal:hover {
    background: linear-gradient(135deg, rgba(56, 189, 248, 0.25), rgba(34, 211, 238, 0.25));
    border-color: var(--accent-cyan);
    box-shadow: 0 0 20px rgba(34, 211, 238, 0.2);
  }

  .btn-signal:active {
    transform: scale(0.97);
  }

  /* ============================
     STEP-BY-STEP WORKFLOW CARDS
     Explains each phase of the neural network process
     ============================ */
  .workflow {
    display: grid;
    grid-template-columns: 1fr;
    gap: 20px;
    margin-top: 40px;
  }

  @media (min-width: 768px) {
    .workflow {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  .step-card {
    background: var(--bg-card);
    border: 1px solid var(--border-subtle);
    border-radius: 16px;
    padding: 28px;
    position: relative;
    transition: all 0.3s ease;
    overflow: hidden;
  }

  .step-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    border-radius: 16px 16px 0 0;
  }

  /* Each step gets a unique accent color on its top border */
  .step-card:nth-child(1)::before { background: var(--accent-blue); }
  .step-card:nth-child(2)::before { background: var(--accent-purple); }
  .step-card:nth-child(3)::before { background: var(--accent-orange); }
  .step-card:nth-child(4)::before { background: var(--accent-green); }
  .step-card:nth-child(5)::before { background: var(--accent-pink); }
  .step-card:nth-child(6)::before { background: var(--accent-cyan); }

  .step-card:hover {
    border-color: rgba(56, 189, 248, 0.3);
    transform: translateY(-2px);
  }

  .step-number {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    color: var(--text-muted);
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 10px;
  }

  .step-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 10px;
  }

  .step-desc {
    color: var(--text-secondary);
    font-weight: 300;
    font-size: 0.95rem;
    line-height: 1.65;
  }

  .step-analogy {
    margin-top: 12px;
    padding: 10px 14px;
    background: rgba(56, 189, 248, 0.05);
    border-left: 2px solid var(--accent-blue);
    border-radius: 0 8px 8px 0;
    font-size: 0.85rem;
    color: var(--accent-blue);
    font-style: italic;
  }

  /* ============================
     LEGEND - explains the diagram symbols
     ============================ */
  .legend {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 24px;
    margin-top: 16px;
    padding: 16px;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.8rem;
    color: var(--text-secondary);
    font-family: 'JetBrains Mono', monospace;
  }

  .legend-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: 2px solid;
  }

  /* ============================
     TOOLTIP on hover over neurons
     ============================ */
  .tooltip {
    position: fixed;
    background: #1e293b;
    border: 1px solid rgba(56, 189, 248, 0.3);
    color: var(--text-primary);
    padding: 10px 14px;
    border-radius: 10px;
    font-size: 0.82rem;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s ease;
    z-index: 100;
    max-width: 220px;
    font-family: 'Outfit', sans-serif;
    box-shadow: 0 8px 24px rgba(0,0,0,0.4);
  }

  .tooltip.visible {
    opacity: 1;
  }

  .tooltip-title {
    font-weight: 600;
    color: var(--accent-cyan);
    margin-bottom: 4px;
    font-size: 0.85rem;
  }

  /* ============================
     FOOTER
     ============================ */
  .footer {
    text-align: center;
    margin-top: 48px;
    padding-top: 24px;
    border-top: 1px solid var(--border-subtle);
    color: var(--text-muted);
    font-size: 0.8rem;
  }

  /* ============================
     MOBILE OPTIMIZATIONS
     ============================ */
  @media (max-width: 768px) {
    .nav-inner {
      height: auto;
      min-height: 52px;
      flex-wrap: wrap;
      padding: 8px 0;
      gap: 8px;
    }
    .nav-brand { font-size: 0.7rem; }
    .nav-links {
      width: 100%;
      justify-content: center;
      flex-wrap: wrap;
      gap: 2px;
    }
    .nav-link { font-size: 0.72rem; padding: 5px 8px; }
    .nav-sep { display: none; }
    .container { padding: 24px 16px; }
    .header { margin-bottom: 32px; }
    .header h1 { font-size: 1.5rem; }
    .header .subtitle { font-size: 0.7rem; letter-spacing: 2px; }
    .header p { font-size: 0.9rem; }
    .diagram-section { padding: 20px 8px 16px; border-radius: 12px; }
    .diagram-svg { min-height: 300px; }
    .controls { flex-direction: column; gap: 10px; }
    .btn { width: 100%; padding: 12px 16px; font-size: 0.78rem; }
    .step-card, .layer-card, .concept-card { padding: 20px 16px; }
    .step-title, .layer-title { font-size: 1rem; }
    .step-desc, .layer-desc { font-size: 0.85rem; }
    .footer { font-size: 0.7rem; margin-top: 32px; }
  }
  @media (max-width: 480px) {
    .nav-bar { padding: 0 12px; }
    .nav-link { font-size: 0.68rem; padding: 4px 6px; }
    .header h1 { font-size: 1.3rem; }
    .container { padding: 16px 12px; }
  }

</style>
</head>
<body>

<!-- ============================
     NAVIGATION BAR
     Sticky top nav with frosted glass effect.
     "active" class marks the current page.
     To add more pages, just add more <a class="nav-link"> tags
     and a <div class="nav-sep"></div> between them.
     ============================ -->
<nav class="nav-bar">
  <div class="nav-inner">
    <!-- Left side: site brand -->
    <a href="/" class="nav-brand">‚ö° AI Concepts</a>

    <!-- Right side: page links -->
    <div class="nav-links">
      <a href="/" class="nav-link active">Neural Networks</a>
      <div class="nav-sep"></div>
      <a href="/rag/how-rag-works" class="nav-link">RAG Pipeline</a>
      <div class="nav-sep"></div>
      <a href="/transformers/how-transformers-work" class="nav-link">Transformers</a>
      <div class="nav-sep"></div>
      <a href="/agentic-ai/how-agents-work" class="nav-link">Agentic AI</a>
      <div class="nav-sep"></div>
      <a href="/training/how-training-works" class="nav-link">Training Pipeline</a>
      <div class="nav-sep"></div>
      <a href="/ai-security/securing-ai" class="nav-link">AI Security</a>
      <div class="nav-sep"></div>
      <a href="/lab/lab-architecture" class="nav-link">Lab Architecture</a>
    </div>
  </div>
</nav>

<!-- ============================
     TOOLTIP ELEMENT
     This follows the mouse when hovering over neurons
     ============================ -->
<div class="tooltip" id="tooltip">
  <div class="tooltip-title" id="tooltip-title"></div>
  <div id="tooltip-text"></div>
</div>

<div class="container">

  <!-- ============================
       HEADER
       ============================ -->
  <div class="header">
    <h1>How an AI Neural Network Works</h1>
    <p>An interactive diagram showing how data flows through layers of artificial neurons ‚Äî from input to output.</p>
  </div>

  <!-- ============================
       MAIN DIAGRAM
       This SVG draws the neural network with:
       - 3 input neurons (left)
       - 4 hidden layer 1 neurons
       - 4 hidden layer 2 neurons
       - 2 output neurons (right)
       - Lines connecting every neuron to the next layer
       ============================ -->
  <div class="diagram-section">
    <svg class="diagram-svg" viewBox="0 0 900 520" xmlns="http://www.w3.org/2000/svg" id="nn-svg">

      <!-- 
        CONNECTIONS (drawn first so they appear behind the neurons)
        Each line connects a neuron in one layer to every neuron in the next layer.
        This represents how each neuron's output feeds into all neurons of the next layer.
      -->
      <g id="connections">
        <!-- These get drawn by JavaScript below -->
      </g>

      <!-- 
        LAYER LABELS
        Text labels at the top of each column explaining what that layer does
      -->
      <!-- Input Layer label -->
      <text class="layer-label" x="130" y="38">Input</text>
      <text class="layer-sublabel" x="130" y="54">Raw Data</text>

      <!-- Hidden Layer 1 label -->
      <text class="layer-label" x="340" y="38">Hidden 1</text>
      <text class="layer-sublabel" x="340" y="54">Find Patterns</text>

      <!-- Hidden Layer 2 label -->
      <text class="layer-label" x="560" y="38">Hidden 2</text>
      <text class="layer-sublabel" x="560" y="54">Combine Patterns</text>

      <!-- Output Layer label -->
      <text class="layer-label" x="770" y="38">Output</text>
      <text class="layer-sublabel" x="770" y="54">Prediction</text>

      <!-- 
        NEURONS (circles)
        Each group (.neuron) contains:
        - A colored circle (the neuron itself)
        - Positioned at specific x,y coordinates per layer
        
        The data-tooltip attributes store the hover text
      -->
      <g id="neurons">
        <!-- These also get drawn by JavaScript for cleaner code -->
      </g>

      <!-- 
        DIRECTION ARROW
        Shows that data flows left ‚Üí right 
      -->
      <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="var(--text-muted)" opacity="0.5" />
        </marker>
      </defs>
      <line x1="100" y1="490" x2="800" y2="490" stroke="var(--text-muted)" stroke-width="1" opacity="0.3" marker-end="url(#arrowhead)" stroke-dasharray="6 4" />
      <text x="450" y="510" text-anchor="middle" fill="var(--text-muted)" font-family="JetBrains Mono, monospace" font-size="10" letter-spacing="2" opacity="0.5">DATA FLOW</text>

    </svg>

    <!-- Legend explaining the color coding -->
    <div class="legend">
      <div class="legend-item">
        <div class="legend-dot" style="border-color: var(--accent-blue); background: rgba(56, 189, 248, 0.2);"></div>
        Input Neurons
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="border-color: var(--accent-purple); background: rgba(167, 139, 250, 0.2);"></div>
        Hidden Neurons
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="border-color: var(--accent-green); background: rgba(74, 222, 128, 0.2);"></div>
        Output Neurons
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="border-color: var(--text-muted); background: rgba(148, 163, 184, 0.1);"></div>
        Connections (Weights)
      </div>
    </div>

    <!-- Button to trigger the signal animation -->
    <div class="controls">
      <button class="btn-signal" id="btn-fire" onclick="fireSignal()">‚ö° Send Signal Through Network</button>
    </div>
  </div>

  <!-- ============================
       STEP-BY-STEP WORKFLOW CARDS
       Each card explains one phase of how a neural network processes data
       ============================ -->
  <div class="workflow">

    <div class="step-card">
      <div class="step-number">Step 01</div>
      <div class="step-title">üì• Input Layer ‚Äî Receive Data</div>
      <div class="step-desc">
        Raw data enters the network. Each input neuron represents one feature of the data ‚Äî like a pixel value in an image or a word in a sentence.
      </div>
      <div class="step-analogy">üß† Like your eyes seeing an image ‚Äî raw sensory input.</div>
    </div>

    <div class="step-card">
      <div class="step-number">Step 02</div>
      <div class="step-title">‚öñÔ∏è Weights ‚Äî Scale the Signal</div>
      <div class="step-desc">
        Each connection between neurons has a "weight" ‚Äî a number that controls how much influence one neuron has on the next. These are the artificial synapses. Strong weight = strong influence.
      </div>
      <div class="step-analogy">üß† Like synapses in your brain ‚Äî some connections are stronger than others.</div>
    </div>

    <div class="step-card">
      <div class="step-number">Step 03</div>
      <div class="step-title">üî¢ Hidden Layers ‚Äî Find Patterns</div>
      <div class="step-desc">
        Each hidden neuron adds up its weighted inputs, applies a math function (called an "activation function"), and passes the result forward. Early layers detect simple patterns; deeper layers combine them into complex features.
      </div>
      <div class="step-analogy">üß† Like your brain recognizing edges ‚Üí shapes ‚Üí faces as signals travel deeper.</div>
    </div>

    <div class="step-card">
      <div class="step-number">Step 04</div>
      <div class="step-title">üì§ Output Layer ‚Äî Make a Prediction</div>
      <div class="step-desc">
        The final layer produces the network's answer ‚Äî a classification ("cat" vs "dog"), a number (stock price), or generated text. Each output neuron represents a possible result.
      </div>
      <div class="step-analogy">üß† Like your brain deciding "that's a cat!" after processing visual info.</div>
    </div>

    <div class="step-card">
      <div class="step-number">Step 05</div>
      <div class="step-title">‚ùå Loss ‚Äî Check the Error</div>
      <div class="step-desc">
        The network compares its prediction to the correct answer and calculates how wrong it was. This error score is called the "loss." The bigger the loss, the more adjustments are needed.
      </div>
      <div class="step-analogy">üß† Like missing a dart throw and seeing how far off you were.</div>
    </div>

    <div class="step-card">
      <div class="step-number">Step 06</div>
      <div class="step-title">üîÑ Backpropagation ‚Äî Learn &amp; Adjust</div>
      <div class="step-desc">
        The error travels backward through the network, and each weight gets adjusted slightly to reduce the error next time. This cycle repeats millions of times until the network becomes accurate.
      </div>
      <div class="step-analogy">üß† Like adjusting your dart throw each time ‚Äî "a little more left, less force..."</div>
    </div>

  </div>

  <div class="footer">
    Interactive Neural Network Diagram ‚Äî Hover over neurons for details, click "Send Signal" to watch data flow
  </div>
</div>

<script>
  // ============================
  // NEURAL NETWORK CONFIGURATION
  // Define where each neuron sits and what layer it belongs to
  // ============================

  // Each layer is an object with:
  //   x: horizontal position
  //   count: how many neurons in this layer
  //   color: fill color for the neuron circle
  //   border: stroke color for the circle outline
  //   label: which layer it belongs to (for tooltips)
  const layers = [
    {
      x: 130,         // x position on the SVG canvas
      count: 3,       // 3 input neurons
      color: 'rgba(56, 189, 248, 0.2)',   // blue fill (semi-transparent)
      border: '#38bdf8',                   // blue border
      label: 'Input',
      tooltips: [
        { title: 'Input Neuron 1', text: 'Receives raw data feature #1 (e.g., a pixel value or word embedding)' },
        { title: 'Input Neuron 2', text: 'Receives raw data feature #2 ‚Äî no processing, just passes data forward' },
        { title: 'Input Neuron 3', text: 'Receives raw data feature #3 ‚Äî real networks can have millions of inputs' }
      ]
    },
    {
      x: 340,
      count: 4,       // 4 neurons in hidden layer 1
      color: 'rgba(167, 139, 250, 0.2)',   // purple fill
      border: '#a78bfa',
      label: 'Hidden 1',
      tooltips: [
        { title: 'Hidden Neuron', text: 'Sums weighted inputs, applies activation function, detects simple patterns' },
        { title: 'Hidden Neuron', text: 'Each neuron specializes in detecting a different pattern in the data' },
        { title: 'Hidden Neuron', text: 'The "bias" value lets this neuron adjust its activation threshold' },
        { title: 'Hidden Neuron', text: 'Uses ReLU, Sigmoid, or similar activation functions to add non-linearity' }
      ]
    },
    {
      x: 560,
      count: 4,       // 4 neurons in hidden layer 2
      color: 'rgba(167, 139, 250, 0.2)',
      border: '#a78bfa',
      label: 'Hidden 2',
      tooltips: [
        { title: 'Deep Neuron', text: 'Combines simple patterns from layer 1 into more complex features' },
        { title: 'Deep Neuron', text: 'Deeper layers understand higher-level concepts (edges ‚Üí shapes ‚Üí objects)' },
        { title: 'Deep Neuron', text: 'More hidden layers = "deeper" network = can learn more complex things' },
        { title: 'Deep Neuron', text: 'This is why it\'s called "deep learning" ‚Äî many layers deep!' }
      ]
    },
    {
      x: 770,
      count: 2,       // 2 output neurons
      color: 'rgba(74, 222, 128, 0.2)',    // green fill
      border: '#4ade80',
      label: 'Output',
      tooltips: [
        { title: 'Output: "Cat" (87%)', text: 'Outputs a confidence score ‚Äî high value means the network thinks this is the answer' },
        { title: 'Output: "Dog" (13%)', text: 'Lower confidence ‚Äî the network doesn\'t think this matches as well' }
      ]
    }
  ];

  // ============================
  // CALCULATE NEURON POSITIONS
  // Spread neurons evenly in each column
  // ============================
  const svgHeight = 520;     // total SVG height
  const topPadding = 80;     // space for labels at top
  const bottomPadding = 70;  // space for arrow at bottom
  const usableHeight = svgHeight - topPadding - bottomPadding;

  // neuronPositions will store [x, y] for every neuron, grouped by layer
  // Example: neuronPositions[0] = [[130, 140], [130, 260], [130, 380]]  (3 input neurons)
  const neuronPositions = [];

  layers.forEach(layer => {
    const positions = [];
    const spacing = usableHeight / (layer.count + 1);  // evenly divide the space
    for (let i = 0; i < layer.count; i++) {
      const y = topPadding + spacing * (i + 1);  // calculate y position
      positions.push([layer.x, y]);
    }
    neuronPositions.push(positions);
  });

  // ============================
  // DRAW CONNECTION LINES
  // Connect every neuron in layer N to every neuron in layer N+1
  // This is called a "fully connected" or "dense" layer
  // ============================
  const connectionsGroup = document.getElementById('connections');

  // Store references to all connection lines so we can animate them later
  const connectionElements = [];

  for (let layerIdx = 0; layerIdx < neuronPositions.length - 1; layerIdx++) {
    const currentLayer = neuronPositions[layerIdx];
    const nextLayer = neuronPositions[layerIdx + 1];

    const layerConnections = [];

    // For each neuron in the current layer...
    currentLayer.forEach(([x1, y1]) => {
      // ...draw a line to EVERY neuron in the next layer
      nextLayer.forEach(([x2, y2]) => {
        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', x1);
        line.setAttribute('y1', y1);
        line.setAttribute('x2', x2);
        line.setAttribute('y2', y2);
        line.setAttribute('stroke', 'rgba(56, 189, 248, 0.08)');  // very faint blue
        line.setAttribute('stroke-width', '1');
        line.classList.add('connection');
        connectionsGroup.appendChild(line);
        layerConnections.push(line);
      });
    });

    connectionElements.push(layerConnections);
  }

  // ============================
  // DRAW NEURONS (CIRCLES)
  // Each neuron is an SVG circle with hover effects
  // ============================
  const neuronsGroup = document.getElementById('neurons');

  // Store references to all neuron circles for the signal animation
  const neuronCircles = [];

  layers.forEach((layer, layerIdx) => {
    const layerCircles = [];

    neuronPositions[layerIdx].forEach(([x, y], neuronIdx) => {
      // Create a group element to hold the circle and make it hoverable
      const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
      g.classList.add('neuron');

      // The main circle
      const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
      circle.setAttribute('cx', x);
      circle.setAttribute('cy', y);
      circle.setAttribute('r', '20');              // radius of 20px
      circle.setAttribute('fill', layer.color);     // semi-transparent fill
      circle.setAttribute('stroke', layer.border);  // colored border
      circle.setAttribute('stroke-width', '2');
      circle.classList.add('neuron-circle');

      // A smaller inner dot for visual depth
      const innerDot = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
      innerDot.setAttribute('cx', x);
      innerDot.setAttribute('cy', y);
      innerDot.setAttribute('r', '5');
      innerDot.setAttribute('fill', layer.border);
      innerDot.setAttribute('opacity', '0.6');

      g.appendChild(circle);
      g.appendChild(innerDot);

      // Store tooltip data on the element so we can show it on hover
      const tooltip = layer.tooltips[neuronIdx];
      g.setAttribute('data-tooltip-title', tooltip.title);
      g.setAttribute('data-tooltip-text', tooltip.text);

      // Add hover event listeners for the tooltip
      g.addEventListener('mouseenter', showTooltip);
      g.addEventListener('mousemove', moveTooltip);
      g.addEventListener('mouseleave', hideTooltip);

      neuronsGroup.appendChild(g);
      layerCircles.push(circle);
    });

    neuronCircles.push(layerCircles);
  });

  // ============================
  // TOOLTIP FUNCTIONS
  // Show/hide a floating tooltip when hovering over neurons
  // ============================
  const tooltipEl = document.getElementById('tooltip');
  const tooltipTitle = document.getElementById('tooltip-title');
  const tooltipText = document.getElementById('tooltip-text');

  function showTooltip(e) {
    // Read the tooltip data from the hovered element's attributes
    const target = e.currentTarget;
    tooltipTitle.textContent = target.getAttribute('data-tooltip-title');
    tooltipText.textContent = target.getAttribute('data-tooltip-text');
    tooltipEl.classList.add('visible');
  }

  function moveTooltip(e) {
    // Position the tooltip near the mouse cursor
    const tooltipWidth = tooltipEl.offsetWidth || 260;
    const viewportWidth = window.innerWidth;
    const spaceOnRight = viewportWidth - e.clientX;
    
    if (spaceOnRight < tooltipWidth + 32) {
      tooltipEl.style.left = (e.clientX - tooltipWidth - 16) + 'px';
    } else {
      tooltipEl.style.left = (e.clientX + 16) + 'px';
    }
    tooltipEl.style.top = (e.clientY - 10) + 'px';
  }

  function hideTooltip() {
    tooltipEl.classList.remove('visible');
  }

  // ============================
  // FIRE SIGNAL ANIMATION
  // When the button is clicked, neurons light up layer by layer
  // (left to right) to simulate data flowing through the network
  // ============================
  let isAnimating = false;  // prevent clicking during animation

  function fireSignal() {
    if (isAnimating) return;  // don't restart if already running
    isAnimating = true;

    const btn = document.getElementById('btn-fire');
    btn.textContent = '‚ö° Signal Propagating...';
    btn.style.opacity = '0.6';

    // For each layer, fire neurons after a delay
    // This creates the left-to-right "wave" effect
    layers.forEach((layer, layerIdx) => {
      // Each layer fires 400ms after the previous one
      const delay = layerIdx * 400;

      setTimeout(() => {
        // Light up all neurons in this layer
        neuronCircles[layerIdx].forEach(circle => {
          circle.classList.add('firing');

          // Remove the animation class after it completes
          setTimeout(() => circle.classList.remove('firing'), 600);
        });

        // Flash the connections FROM this layer to the next
        if (layerIdx < connectionElements.length) {
          connectionElements[layerIdx].forEach(line => {
            line.classList.add('flashing');
            setTimeout(() => line.classList.remove('flashing'), 500);
          });
        }
      }, delay);
    });

    // Reset the button after the full animation completes
    const totalDuration = layers.length * 400 + 600;
    setTimeout(() => {
      btn.textContent = '‚ö° Send Signal Through Network';
      btn.style.opacity = '1';
      isAnimating = false;
    }, totalDuration);
  }
</script>

</body>
</html>
